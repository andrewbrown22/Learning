package adventOfCode2022Take2

object Day4 extends App {

  val input: List[List[Int]] = "14-38,14-14\n2-10,3-55\n36-90,36-46\n9-97,8-87\n75-92,51-92\n6-82,1-83\n21-79,29-80\n26-66,27-27\n11-32,11-32\n6-90,91-91\n36-78,21-65\n66-66,23-66\n22-23,22-95\n3-82,3-35\n1-92,93-93\n1-96,1-1\n12-54,9-53\n80-98,4-80\n7-63,3-63\n2-2,2-21\n33-95,85-94\n60-60,60-80\n76-97,96-98\n1-98,2-2\n69-96,68-98\n63-84,63-63\n24-31,23-28\n16-71,40-70\n30-63,64-64\n20-61,64-77\n57-90,17-58\n57-58,12-58\n10-74,10-74\n14-65,64-72\n95-99,8-90\n26-46,45-75\n18-66,17-19\n21-56,21-21\n42-75,70-74\n5-46,45-47\n20-79,20-79\n1-99,2-99\n16-31,17-30\n10-30,8-9\n1-99,1-99\n51-91,50-97\n18-39,18-39\n9-97,4-9\n5-76,6-6\n88-92,88-89\n11-91,19-92\n70-74,2-42\n65-93,94-94\n10-96,9-95\n8-40,6-35\n3-11,12-12\n17-88,17-89\n8-41,7-9\n9-60,60-66\n56-86,86-87\n58-67,58-86\n14-90,7-90\n3-82,2-81\n54-56,20-55\n2-88,4-87\n5-79,6-6\n95-95,19-95\n37-94,38-94\n2-12,2-36\n9-46,46-47\n58-80,66-81\n96-98,1-97\n72-85,84-85\n52-55,52-61\n74-76,6-75\n1-65,2-88\n22-58,22-58\n29-97,30-96\n3-5,5-62\n2-89,2-72\n20-62,69-76\n63-66,62-65\n18-20,19-35\n17-88,17-87\n14-99,13-98\n46-84,46-81\n4-98,3-5\n3-76,75-75\n84-92,91-95\n38-83,4-83\n4-53,5-77\n58-86,58-74\n21-97,96-97\n7-7,7-34\n9-38,9-36\n29-43,43-78\n56-97,55-56\n89-90,9-89\n4-47,48-88\n23-58,58-76\n5-55,32-55\n34-48,41-45\n98-98,44-99\n14-92,48-92\n22-96,23-98\n25-43,73-95\n71-79,72-77\n74-94,93-95\n14-90,89-89\n5-32,4-99\n4-58,4-59\n4-96,4-4\n62-83,54-84\n66-67,67-68\n25-42,25-42\n13-79,12-78\n4-65,2-92\n4-65,3-4\n6-83,7-82\n74-76,41-75\n3-62,61-62\n10-39,11-30\n19-93,3-42\n25-25,11-26\n37-52,53-77\n3-97,97-98\n22-67,23-77\n47-96,35-35\n25-84,23-25\n6-86,86-86\n62-62,48-62\n41-95,42-95\n12-75,13-76\n7-69,6-70\n78-91,35-78\n17-80,79-81\n49-77,50-78\n96-99,20-97\n7-9,8-78\n85-86,58-87\n8-8,8-80\n17-66,43-67\n48-60,22-65\n9-67,67-67\n9-45,10-62\n43-73,44-83\n80-96,80-93\n72-87,85-88\n16-61,13-16\n92-92,2-91\n22-43,42-43\n31-83,30-79\n38-95,38-97\n63-85,71-84\n11-11,11-19\n13-14,13-56\n2-5,4-81\n59-64,62-65\n71-89,8-59\n93-99,87-94\n25-25,26-72\n56-98,57-97\n33-36,37-94\n38-85,84-86\n1-79,78-94\n77-98,76-99\n14-72,13-71\n17-92,18-86\n18-99,57-98\n2-87,3-87\n78-95,86-94\n43-44,32-46\n59-62,60-62\n12-24,24-25\n41-66,21-66\n13-82,13-83\n53-87,11-87\n7-96,7-96\n24-26,25-32\n13-70,8-13\n12-93,12-17\n4-39,5-38\n95-97,73-96\n73-81,74-83\n57-62,63-63\n58-59,56-59\n38-98,38-97\n20-75,19-74\n8-62,74-99\n2-96,3-91\n7-97,6-8\n1-99,1-99\n41-81,42-80\n91-91,43-92\n4-73,4-4\n40-43,42-54\n37-66,47-56\n88-89,20-73\n10-98,10-98\n51-81,51-51\n36-81,5-36\n16-64,61-64\n22-98,21-99\n29-76,75-77\n2-95,1-96\n58-58,2-58\n10-62,11-42\n8-8,35-90\n53-78,53-94\n9-74,10-73\n41-86,40-86\n2-40,3-80\n26-26,25-62\n38-99,37-97\n24-91,25-98\n26-93,25-94\n31-53,1-54\n16-47,24-47\n25-91,39-92\n22-91,40-92\n8-23,8-8\n83-88,83-90\n62-85,63-86\n27-48,27-27\n50-58,37-59\n5-74,5-64\n29-77,29-77\n19-24,19-19\n12-12,11-87\n37-87,38-71\n99-99,12-95\n77-77,24-78\n72-85,71-99\n7-7,7-87\n3-97,58-96\n14-16,15-99\n47-94,93-94\n36-82,14-82\n2-22,9-21\n2-74,73-75\n88-88,46-88\n1-93,93-93\n48-67,48-67\n78-78,12-77\n52-99,34-52\n66-66,65-71\n64-92,65-91\n18-44,19-58\n38-44,27-38\n44-99,44-85\n69-84,31-81\n44-86,44-86\n76-77,2-76\n71-72,24-72\n23-72,24-72\n8-23,9-22\n76-96,92-94\n7-77,76-76\n14-15,17-79\n13-99,14-96\n34-90,33-43\n6-81,6-81\n17-73,3-11\n2-22,3-23\n88-99,87-98\n6-52,52-53\n8-93,76-94\n88-95,84-96\n64-94,64-67\n12-29,11-30\n50-58,32-59\n70-90,71-90\n50-57,58-59\n2-65,1-64\n9-45,8-44\n57-90,56-88\n7-84,7-7\n46-84,45-45\n17-59,16-58\n3-11,11-15\n64-93,20-70\n54-93,54-92\n23-24,23-92\n17-82,17-26\n21-79,78-94\n18-94,93-94\n25-40,26-84\n20-83,19-83\n20-20,20-90\n1-96,88-96\n12-57,13-13\n26-99,26-98\n69-70,39-69\n14-83,82-82\n24-99,24-98\n2-10,10-82\n16-62,41-82\n1-71,1-72\n26-30,25-29\n5-96,5-99\n8-8,7-61\n26-99,27-27\n26-90,8-19\n22-89,22-90\n7-68,69-69\n57-59,3-58\n92-93,86-92\n51-83,50-77\n87-87,11-86\n2-51,3-81\n63-65,25-64\n34-81,33-83\n5-37,5-91\n13-55,1-24\n15-15,15-83\n18-22,18-88\n11-41,11-41\n93-95,6-94\n65-68,65-70\n31-87,32-81\n11-84,3-85\n96-97,32-97\n27-67,66-68\n87-89,22-88\n31-75,24-76\n18-96,17-97\n3-95,4-36\n66-99,67-97\n21-71,22-72\n56-77,78-85\n2-96,3-95\n20-93,92-92\n35-97,96-98\n32-37,17-36\n8-95,7-94\n21-81,7-81\n68-69,68-89\n22-47,23-48\n23-78,23-24\n50-52,12-51\n14-96,14-98\n18-46,34-45\n2-88,1-2\n11-60,10-12\n97-97,60-97\n18-70,19-71\n5-94,93-95\n68-95,67-87\n12-87,93-95\n58-68,57-60\n92-93,5-92\n21-21,20-71\n48-82,81-99\n9-59,10-84\n29-50,29-94\n14-15,14-15\n65-90,65-80\n10-36,10-35\n24-81,80-82\n9-10,10-51\n48-54,54-54\n49-50,50-56\n58-92,57-70\n16-27,4-17\n1-98,23-99\n31-94,93-93\n39-41,8-40\n87-95,95-95\n58-90,59-89\n9-97,30-97\n10-79,10-78\n3-41,3-41\n3-63,62-63\n65-97,66-66\n83-83,65-84\n16-60,17-59\n61-83,63-84\n66-68,66-67\n78-78,18-79\n13-83,12-82\n20-69,21-69\n25-95,60-96\n22-22,22-97\n28-85,2-84\n65-84,84-85\n43-87,88-88\n4-4,3-99\n4-84,2-4\n53-55,45-54\n16-17,11-70\n44-98,44-97\n43-64,43-58\n28-37,19-27\n23-77,76-78\n1-92,6-92\n52-86,52-86\n59-86,58-59\n8-94,7-95\n48-98,98-98\n46-49,47-48\n31-82,32-85\n58-87,57-87\n45-47,46-86\n61-86,61-76\n38-84,37-85\n92-92,53-93\n21-68,22-68\n69-98,70-98\n17-91,92-92\n35-35,35-35\n17-53,17-53\n26-40,37-37\n22-88,22-88\n10-30,10-30\n97-99,27-98\n17-37,17-37\n19-31,19-28\n4-86,3-85\n11-32,12-31\n67-77,67-98\n12-40,9-9\n36-83,83-84\n10-71,70-70\n57-92,15-84\n1-4,3-91\n3-11,7-12\n31-90,90-91\n5-22,2-5\n6-91,5-91\n92-92,40-72\n4-8,12-97\n5-76,52-75\n5-91,91-91\n2-99,1-96\n19-43,19-43\n48-98,47-97\n25-96,19-97\n3-91,3-99\n11-13,12-38\n67-71,17-71\n11-11,10-99\n1-6,5-97\n57-57,35-57\n87-89,24-88\n92-92,29-93\n31-35,28-36\n20-80,19-19\n82-82,5-82\n10-31,32-55\n18-82,28-81\n29-73,29-88\n10-93,10-10\n40-42,40-42\n22-32,22-26\n71-72,58-71\n36-97,36-41\n5-94,5-98\n96-99,87-97\n12-95,13-95\n97-99,20-98\n24-84,24-84\n76-92,75-97\n14-54,14-53\n37-51,37-52\n69-71,35-70\n41-41,35-40\n35-92,92-92\n58-68,57-67\n57-75,27-76\n21-85,22-84\n42-59,41-41\n96-96,1-96\n27-29,28-98\n14-81,15-15\n42-94,42-93\n22-59,15-60\n3-98,3-69\n15-15,3-15\n67-82,36-47\n27-54,10-55\n44-57,43-56\n56-68,56-56\n90-92,33-91\n92-94,82-95\n8-69,69-69\n37-76,36-75\n21-96,1-21\n15-15,10-18\n83-83,9-83\n11-11,11-64\n34-94,25-93\n54-77,77-77\n34-70,35-70\n20-96,20-77\n59-64,32-63\n28-75,27-97\n3-85,2-86\n52-89,52-91\n43-54,45-53\n20-27,20-28\n45-91,68-89\n7-61,12-84\n7-94,6-95\n32-33,32-79\n2-5,5-99\n7-63,6-53\n16-78,17-78\n19-54,54-54\n66-74,66-75\n20-93,21-93\n42-98,1-99\n5-24,4-5\n10-95,94-95\n1-99,1-99\n81-81,81-96\n39-39,23-38\n3-41,3-4\n35-71,36-36\n11-39,38-88\n39-56,40-57\n1-6,6-82\n11-34,1-34\n7-7,7-94\n3-97,2-98\n47-99,47-99\n66-91,96-97\n5-89,97-99\n62-62,36-61\n7-17,6-16\n96-96,57-78\n83-95,13-94\n98-99,1-99\n2-93,92-93\n93-93,51-92\n23-23,23-84\n45-82,44-82\n7-32,7-33\n9-97,10-75\n23-77,25-69\n9-91,8-9\n4-95,47-93\n64-67,2-96\n48-72,72-73\n46-92,45-93\n2-95,94-95\n68-76,69-69\n2-51,8-51\n57-81,82-94\n7-60,13-60\n24-71,23-35\n24-97,24-97\n24-94,32-95\n21-35,21-22\n22-51,23-76\n32-94,32-91\n9-94,9-90\n87-88,9-87\n5-12,7-13\n35-73,74-74\n61-64,48-65\n17-94,71-94\n54-54,29-57\n75-77,19-76\n14-14,15-72\n14-14,14-43\n29-33,29-95\n1-1,1-81\n46-81,80-80\n39-66,10-66\n55-88,55-71\n91-94,34-96\n28-93,27-89\n56-97,55-71\n17-94,93-95\n27-67,26-66\n90-99,83-98\n24-25,24-70\n42-98,79-99\n94-94,46-88\n7-71,70-81\n29-95,28-83\n85-85,3-84\n12-89,63-88\n8-31,9-9\n3-93,70-95\n19-19,19-94\n16-40,1-41\n54-88,88-88\n39-39,29-39\n39-59,59-59\n20-80,19-79\n2-7,2-53\n20-97,19-58\n4-70,4-70\n56-89,55-90\n86-95,95-95\n66-93,65-73\n4-84,5-85\n34-88,33-41\n26-61,26-78\n48-79,49-79\n66-99,52-99\n77-77,43-78\n49-90,50-80\n17-71,16-37\n45-91,45-90\n71-71,27-70\n96-96,3-96\n15-89,14-90\n17-96,7-96\n95-95,2-94\n12-85,11-54\n58-67,34-73\n28-54,29-90\n6-84,5-83\n11-49,48-48\n71-71,11-72\n29-99,99-99\n18-92,19-93\n85-86,35-85\n51-73,51-89\n1-99,57-99\n29-53,28-81\n6-62,7-63\n78-78,77-79\n18-43,18-71\n31-32,32-50\n14-39,40-40\n41-62,42-61\n3-69,5-68\n51-57,48-58\n40-40,41-98\n11-12,11-47\n8-81,8-84\n24-54,10-55\n4-48,5-97\n11-90,11-56\n78-92,78-78\n10-66,67-76\n92-92,13-93\n75-98,67-68\n4-95,2-96\n15-70,16-23\n21-67,20-21\n38-48,38-47\n77-81,80-82\n25-74,30-73\n90-90,91-91\n28-70,20-71\n16-89,37-93\n55-68,34-69\n7-97,50-97\n16-38,17-37\n81-81,34-81\n28-81,27-29\n20-73,19-29\n51-83,52-82\n57-57,56-56\n63-76,20-62\n47-56,46-48\n14-63,62-62\n16-64,63-65\n86-97,87-96\n3-3,3-57\n26-27,20-27\n2-99,3-3\n1-2,1-49\n16-58,31-59\n2-14,2-46\n6-31,5-50\n19-65,19-65\n34-38,27-37\n2-91,3-90\n5-78,5-78\n7-20,6-19\n44-60,44-59\n61-83,61-61\n35-38,36-57\n4-98,5-99\n5-5,4-86\n4-64,21-88\n34-73,34-76\n52-78,51-79\n95-97,7-96\n50-56,51-57\n4-97,5-97\n2-80,11-79\n15-33,4-15\n1-19,19-85\n2-98,17-97\n40-49,39-84\n17-19,18-75\n49-49,48-74\n72-72,12-72\n15-77,14-98\n2-85,6-58\n45-74,32-44\n10-95,9-9\n83-83,16-83\n62-80,63-90\n25-49,26-52\n67-75,25-59\n25-83,26-73\n52-91,52-52\n69-88,68-89\n56-85,55-95\n9-97,97-97\n36-92,6-36\n45-46,44-46\n28-41,28-41\n18-82,28-87\n30-31,31-96\n5-81,6-6\n14-89,34-88\n27-91,27-27\n96-96,31-96\n16-18,17-30\n17-17,16-84\n3-43,31-45\n31-62,30-61\n48-95,47-60\n16-78,15-78\n48-48,34-48\n3-94,2-95\n1-1,2-2\n86-87,84-89\n31-49,31-66\n13-13,13-46\n4-95,79-95\n3-33,1-34\n4-69,10-69\n29-89,83-90\n25-70,23-71\n59-96,60-83\n78-90,15-83\n15-96,15-76\n80-98,12-79\n41-46,42-47\n1-98,2-97\n25-70,26-71\n4-30,83-93\n43-59,42-59\n25-47,24-48\n2-99,3-99\n1-79,80-80\n2-93,1-92\n7-10,7-10\n55-66,54-65\n9-73,9-73\n23-56,22-56\n22-44,21-45\n11-78,12-79\n7-92,8-87\n58-93,16-94\n24-69,24-94\n94-94,39-94\n34-58,33-58\n49-78,77-77\n7-18,6-19\n74-74,73-93\n44-81,48-81\n11-85,84-84\n29-91,30-92\n17-93,16-17\n1-48,2-78\n11-93,94-94\n12-97,96-96\n6-94,6-6\n19-92,56-67\n10-53,2-10\n14-81,13-90\n23-92,23-93\n38-70,70-71\n42-98,42-66\n37-86,38-99\n11-97,1-97\n48-81,49-49\n11-81,9-20\n44-92,15-44\n68-95,67-97\n57-74,57-74\n34-39,16-38\n27-79,28-80\n50-59,10-60\n13-41,13-30\n77-79,45-78\n24-72,24-80\n12-12,12-66\n10-81,81-82\n4-60,3-61\n31-85,30-31\n23-56,23-69\n21-84,83-84\n8-92,91-91\n27-86,85-91\n64-96,63-99\n2-50,3-50\n70-88,2-71\n11-27,12-27\n31-32,31-55\n2-73,73-85\n27-28,27-27\n68-94,68-79\n4-95,67-96\n22-79,8-22\n3-71,2-70\n6-92,1-92\n74-97,73-93\n2-73,1-66\n10-11,10-96\n29-34,30-34\n43-93,23-42\n25-28,27-28\n52-93,53-94\n62-81,46-63\n8-22,8-8\n10-93,92-94\n10-96,98-99\n2-83,1-1\n14-23,13-17\n27-97,71-96\n2-3,1-8\n4-79,4-58\n52-96,53-89\n19-97,11-19\n18-84,17-85\n39-99,39-88\n25-34,26-31\n41-66,41-65\n2-82,1-83\n8-39,40-40\n35-58,26-58\n5-52,4-51\n4-97,34-96\n53-84,3-74\n3-9,3-97\n2-42,8-96\n4-6,5-95\n53-77,22-53\n16-83,15-82\n41-50,41-74\n11-12,11-78\n39-81,38-82\n7-36,8-37\n3-99,3-97\n50-53,52-54\n7-98,98-98\n30-73,31-31\n90-90,73-90\n74-83,74-83\n45-66,7-65\n15-95,15-16\n53-86,54-87\n1-7,7-86\n64-64,29-63\n17-31,17-75\n26-40,48-98\n18-34,17-33\n45-45,5-45\n24-42,23-42\n66-90,65-91\n15-76,8-27\n4-56,4-56\n59-59,59-66\n20-52,29-63\n56-57,54-57\n90-99,46-73\n6-98,6-98\n7-75,7-75\n28-96,13-96\n39-49,33-50\n45-60,61-79\n8-81,8-90\n6-7,7-73\n43-88,1-99\n87-89,53-88\n79-80,32-80\n7-15,7-15\n40-41,8-40\n28-99,29-56\n47-89,90-90\n66-66,46-66\n6-99,7-98\n13-97,96-97\n67-67,22-68\n61-88,27-89\n12-33,13-13\n3-19,3-40\n10-61,10-99\n13-29,29-97\n50-83,9-49\n1-21,1-91\n48-48,10-48\n51-81,51-51\n39-41,40-98\n61-84,62-83\n4-94,4-93\n3-3,2-29\n87-89,82-88\n3-16,3-40\n36-48,48-48\n27-54,26-53\n50-91,49-91\n1-99,1-1\n16-18,17-41\n74-75,17-75\n25-61,7-25\n40-40,39-83\n41-61,55-61\n58-89,23-89\n10-78,77-79\n9-68,1-9\n9-49,10-94\n64-88,88-88\n43-88,42-89\n55-94,4-94\n23-60,46-59\n14-80,79-81\n39-46,38-45\n35-69,58-68\n38-97,97-97\n7-39,7-87\n33-96,33-71\n3-43,26-42\n1-32,2-96\n55-99,54-56\n50-56,48-55\n44-92,93-93\n10-67,9-9\n31-73,3-31\n8-91,9-9\n19-19,19-61\n63-94,63-94\n7-29,94-99\n11-87,10-92\n10-70,69-71\n15-85,14-85\n11-29,10-13\n61-96,56-95\n6-58,7-7\n79-79,64-78\n70-89,11-90\n7-73,7-73\n62-94,14-62\n15-99,15-25\n8-30,7-71\n20-49,19-21\n20-36,10-36\n9-80,7-9\n42-87,30-88\n9-95,10-96\n10-63,50-90\n13-16,7-15\n25-87,88-88\n5-62,3-62\n9-13,11-99\n5-72,18-73\n75-75,8-75\n1-95,3-95\n18-91,91-91\n12-96,12-13\n32-78,33-78\n2-83,83-95\n33-65,33-33\n66-82,1-67\n65-93,64-93\n35-47,19-34\n22-47,21-42\n4-54,3-55\n44-98,44-45\n99-99,7-97\n95-95,7-94\n43-84,42-83\n28-48,29-67\n2-98,2-3\n2-97,3-95\n68-68,1-67\n20-29,4-30\n16-35,5-47\n22-76,99-99\n6-29,6-29\n24-58,47-57\n2-7,7-68\n56-58,46-57\n36-45,35-71\n13-18,18-18\n13-42,14-43\n72-92,91-93\n82-87,76-84\n79-81,14-80\n38-65,38-38\n42-42,1-41\n2-42,20-67\n20-70,20-70\n28-88,89-94\n6-54,7-55\n77-92,77-94\n37-99,67-90\n9-11,56-71\n43-43,34-43"
    .split('\n').toList.flatMap { str =>
    str.split(Array(',', '-')).map(_.toInt).toList.grouped(4)
  }

  def first(input: List[Int]) = {
    input.head <= input(2) && input(1) >= input(3)
  }

  def second(input: List[Int]) = {
    input(2) <= input.head && input(3) >= input(1)
  }

  def count(input: List[List[Int]]) = {
    input.count(x => first(x) || second(x))
  }

  println(count(input))

  val extendNumberRange: List[(List[Int], List[Int])] = input.map {
    case List(a: Int, b: Int, c: Int, d: Int) => ((a to b).toList, (c to d).toList)
  }

  val second = extendNumberRange.map { x =>
    x._2 count(y => x._1.contains(y))
  }.count(_ > 0)

  println(second)

}
